
<!DOCTYPE html>
<html lang="zh-CN">
<head>


  <meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />

<link rel="manifest" href="./manifest.webmanifest" />
<meta name="theme-color" content="#f5f5f7" />

<!-- iOS PWA -->
<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-status-bar-style" content="default" />
<meta name="apple-mobile-web-app-title" content="Krisy" />

<link rel="apple-touch-icon" sizes="180x180" href="./krisy-icon-180.png">
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Calendar</title>

  <!-- FullCalendar (CDN) -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.11/index.global.min.css">
  <script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.11/index.global.min.js"></script>

  <!-- App styles -->
  <link rel="stylesheet" href="./style.css?v=20260211">
</head>

<body>
  <!-- Top Bar -->
  <div class="topbar">
    <div class="topbar-inner">
    <div class="topbar-left">
      <div class="brand">
        <span class="dot"></span>
        <span class="name">Krisy Calendar</span>
      </div>
      <div class="cloud">
        <button class="btn" id="googleLoginBtn">Google ç™»å½•</button>
        <span class="help" id="cloudStatus">äº‘ç«¯ï¼šæœªè¿æ¥</span>
      </div>
    </div>

    <div class="topbar-center">
      <button class="btn" id="prevBtn">â—€</button>
      <button class="btn" id="todayBtn">ä»Šå¤©</button>
      <button class="btn" id="nextBtn">â–¶</button>

      <div class="titlebar" id="titlebar">â€”</div>

      <div class="seg">
        <button data-view="dayGridMonth" class="active">Month</button>
        <button data-view="timeGridWeek">Week</button>
        <button data-view="timeGridDay">day</button>
      </div>
    </div>

    <div class="topbar-right">
  <button class="btn btn-primary" id="addBtn">ï¼‹ </button>
</div>

  </div>
  </div>

  <!-- Main Layout -->
  <div class="wrap">
    <aside class="sidebar">
      <div class="side-section">
        <div class="side-title">Mini View</div>
        <div class="mini" id="miniCal"></div>
      </div>

      <div class="side-section">
        <div class="side-title">Invoice</div>

        <div style="display:flex; flex-direction:column; gap:10px;">
        <button
           class="btn btn-primary"
           onclick="window.open('./invoice.html', '_blank')"
    >          Create Invoice
        </button>

        <button
          class="btn"
          onclick="window.open('./invoiceRecord.html', '_blank')"
    >          Invoice Record
        </button>
      </div>

  
    <div class="side-section">
       <div class="side-title">Clear</div>
       <button class="btn" id="cleanupBtn" title="åªåˆ é™¤äº‘ç«¯æœªè¢«ä»»ä½•äº‹ä»¶å¼•ç”¨çš„é™„ä»¶">ğŸ§¹ æ™ºèƒ½æ¸…ç†</button>
       <div class="help" style="margin-top:8px;">æ¸…ç†äº‘ç«¯å­¤ç«‹é™„ä»¶ï¼ˆä¸ä¼šå½±å“äº‹ä»¶æœ¬èº«ï¼‰</div>
   </div>

      <div class="side-section">
        <div class="side-title">Export</div>
        <div style="display:flex; flex-direction:column; gap:10px;">
          <div class="help" style="margin-bottom:6px;"></div>
          <div style="display:flex; gap:8px; align-items:center; margin-bottom:8px;">
              <input class="btn" style="padding:8px 10px; flex:1; min-width:0;" id="exportStart" type="date" />
              <span style="flex:0 0 auto; opacity:.6;">â€”</span>
              <input class="btn" style="padding:8px 10px; flex:1; min-width:0;" id="exportEnd" type="date" />
          </div>


          <button class="btn" id="exportMyViewBtn">My_View</button>
          <button class="btn" id="exportTaxBtn"> Tax_Export</button>
          <div class="help">å½“å‰ä¸ºåŸå‹ï¼šå¯¼å‡ºä¸º CSVï¼ˆä¸‹è½½ï¼‰ã€‚</div>
        </div>
     
      
  


<div>
    </aside>

    <main class="content">
      <div id="calendar"></div>
    </main>
  </div>

  <!-- Modal -->
  <div class="overlay" id="overlay">
    <div class="modal" role="dialog" aria-modal="true" aria-labelledby="modalTitle">
      <div class="modal-head">
        <h3 id="modalTitle">Event</h3>
        <button class="btn" id="closeBtn">å…³é—­</button>
      </div>

      <div class="modal-body">
        <div class="grid2">
          <div class="field">
            <label class="req">Type</label>
            <select id="type">
              <option value="Work">Work</option>
              <option value="Expense">Expense</option>
              <option value="Life">Life</option>
            </select>
          </div>

          <div class="field">
            <label class="req">Date</label>
            <input id="date" type="date" />
          </div>

          <div class="field" id="startField">
            <label class="req">Start</label>
            <input id="start" type="time" />
          </div>

          <div class="field" id="durationField">
            <label id="durationLabel">Durationï¼ˆHourï¼‰</label>
            <input id="duration" type="number" step="0.25" min="0" />
            <div class="help" id="durationHelp">Workï¼šå®Œå·¥åå¿…å¡«ï¼›Lifeï¼šå¯é€‰ã€‚</div>
          </div>

          <div class="field" id="clientField">
            <label class="req">Client</label>
            <select id="client"></select>

            <!-- è‡ªåŠ¨æ˜¾ç¤ºåœ°å€ + åœ°å›¾é“¾æ¥ -->
            <div class="help" id="clientAddressBox" style="display:none;">
              <a id="clientMapLink" href="#" target="_blank" rel="noopener noreferrer"></a>
            </div>

            <div class="help"></div>
          </div>

          <div class="field" id="repeatField">
            <label>Repeat</label>
            <select id="repeat">
              <option value="none">Once</option>
              <option value="weekly">Weekly</option>
              <option value="fortnightly">Fornightly</option>
            </select>
            <div class="help">é‡å¤æ—¶è‡ªåŠ¨ç”Ÿæˆ 6 æ¬¡ï¼ˆå«æœ¬æ¬¡ï¼‰</div>
          </div>

          <div class="field">
            <label>Titleï¼ˆå¯é€‰ï¼‰</label>
            <input id="title" type="text" />
          </div>

          <div class="field" id="amountField">
            <label class="req">Amount</label>
            <input id="amount" type="number" step="0.01" min="0" />
            <div class="help" id="amountHelp"></div>
          </div>

          <div class="field" id="categoryField">
            <label class="req">Category</label>
            <select id="category">
              <option value="">è¯·é€‰æ‹©</option>
              <option value="Tools">Tools</option>
              <option value="Fuels">Fuels</option>
              <option value="Vehicle">Vehicle</option>
              <option value="Other">Other</option>
            </select>
          </div>

          <!-- âœ… Sprint2ï¼šé™„ä»¶ï¼ˆæ‹ç…§/ä¸Šä¼  + ç¼©ç•¥å›¾ + å¯åˆ é™¤/æ–°å¢ï¼‰ -->
          <div class="field" id="attachmentField" style="grid-column: 1 / -1;">
            <label id="attachmentLabel">Attachments</label>

            <input
              id="attachmentFiles"
              type="file"
              accept="image/*"
              multiple
            />

            <div class="thumb-grid" id="attachmentPreview"></div>

            <div class="help" id="attachmentHelp">
             
              æç¤ºï¼šé™„ä»¶éœ€è¦ Google ç™»å½•ï¼ˆäº‘ç«¯å­˜å‚¨åœ¨ Driveï¼‰
            </div>
          </div>
        </div>

        <div style="margin-top:12px;" class="help" id="validationHint"></div>
      </div>

      <div class="modal-foot">
        <button class="btn" id="deleteBtn" style="margin-right:auto; display:none;">åˆ é™¤</button>
        <button class="btn" id="saveDraftBtn">æ’ç­/è‰ç¨¿</button>
        <button class="btn btn-primary" id="saveBtn">ä¿å­˜</button>
      </div>
    </div>
  </div>

  <!-- å›¾ç‰‡é¢„è§ˆï¼ˆç‚¹ç¼©ç•¥å›¾æ‰“å¼€å¤§å›¾ï¼‰ -->
  <div class="img-viewer" id="imgViewer" style="display:none;">
    <div class="img-viewer-inner">
      <button class="btn" id="imgViewerClose">å…³é—­</button>
      <img id="imgViewerImg" alt="preview" />
    </div>
  </div>

  <!-- Google Identity Services -->
  <script src="https://accounts.google.com/gsi/client" async defer></script>

  <script src="./app.js" defer></script>
</body>
</html>
